# ログ記録

## 概要

本番環境で発生した問題をデバッグするためには、ログ記録が不可欠です。必要な情報が失われないよう、将来の問題解決に役立つ情報を記録しておく必要があります。スタッ フ＋エンジニアは、アプリケーション、プラットフォーム、ビジネス環境に応じて、ログの記録方法と内容に関する一貫した戦略をチームに導入する役割を担います。

## 詳細

*   **ログ記録戦略の検討項目**:
    *   **ログレベル**: 「デバッグ」「情報」「警告」「エラー」などを使い分け、フィルタリングに活用します。本番環境では警告やエラーのみ出力するなど、ビルドに応じた切り替えも検討します,。
    *   **ログ構造**: 詳細項目、ローカル変数、イベントの順序を判別できる高精度なタイムスタンプ（ミリ秒やナノ秒単位）とタイムゾーンを記録します。
    *   **自動化と保持**: エンジニアの実装漏れを防ぐための自動ログ記録や、ストレージコストと有用性のバランスを考慮した保持期間を決定します,。
*   **指針の策定**:
    *   チーム内で「何を、いつ、どのように記録するか」という合意形成を行い、明示的なプラクティスとして指針を設けます。
    *   **優れたログの条件**: 「いつ（when）、どこで（where）、どのように（how）」起こったかを正確に伝え、アプリケーションが手元になくても分析可能で、システム速度を低下させないものであるべきです,。
    *   **記録すべきイベント**: 認証/認可、データアクセス/変更、無効な入力（悪意ある可能性）、リソース使用状況、システムの健全性/可用性（起動、シャットダウン、エラー、遅延など）が含まれます。
*   **フレームワークの活用**:
    *   場当たり的なログ記録を防ぐため、チームで合意した戦略を反映した軽量なログ記録フレームワークの導入が推奨されます。これにより、基礎となるログ記録ベンダーを抽象化し、将来的な移行を容易にすることができます,。

## ポイント

*   **一貫性の確保**: 各エンジニアが独自のやり方でログを記録すると分析が困難になるため、チーム全体で統一された指針やフレームワークを使用することが重要です。
*   **「正しさ」の強制**: 独自のフレームワークやラッパーを用意することで、「間違った」方法でのログ記録を難しくし、正しい形式での記録を自然に促すことができます。
*   **デバッグへの備え**: ログは単なる記録ではなく、将来発生する問題を解決するための「証拠」であり、手動または自動での分析に適した形式である必要があります,。
