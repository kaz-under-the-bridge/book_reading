# 第17章のまとめ

この章では、テックリードやエンジニアリングチームが、開発したコードを迅速かつ確実に本番環境へ展開（リリース）するための原則、プロセス、およびツールについて解説されています。

## 概要

本番環境へのリリースプロセスには、個人のサイドプロジェクトで行われるような「YOLOリリース（本番環境を直接修正するような無謀なリリース）」から、銀行や医療機器のような規制産業で行われる「徹底的な検証」まで、幅広いスペクトルがあります,。
優れたテックリードは、自身が置かれた環境（スタートアップ、伝統的企業、ビッグテック）に適したアプローチを選択し、開発スピードと信頼性のバランスを取る必要があります。

## 詳細

**1. リリースプロセスの成熟度モデル**
企業のフェーズによって一般的なアプローチが異なります。
*   **スタートアップ**: 速度重視。手動テストが主で、QA（品質保証）は最小限か創業者自身が行うことが多い。
*   **伝統的企業**: QAチームへの依存度が高い。ステージング環境やUAT（ユーザー受け入れテスト）環境での検証を経て、週次などで一括リリースすることが一般的。
*   **ビッグテック**: 自動化への投資が大きい。CI/CD（継続的インテグレーション/デプロイ）、機能フラグ、カナリアリリース、自動ロールバックなどを駆使し、1日に何度もリリースを行う。

**2. 検証の層（レイヤー）とツール**
信頼性を高めるために、複数の検証層を設けることが推奨されます。
*   **自動テスト**: ユニットテスト、インテグレーションテスト、E2Eテスト。
*   **環境**: 独立した開発環境、動的に立ち上がるテスト環境、ステージング環境,。
*   **本番環境でのテスト**: 近年は本番環境を活用する手法が一般的になっています。
    *   **機能フラグ**: コードをデプロイしつつ、機能を無効化しておき、特定のユーザーにのみ有効化してテストする。
    *   **カナリアリリース**: 全ユーザーの1%など、一部にのみ新バージョンを適用し、問題があれば停止する。
    *   **自動ロールバック**: エラー率などのメトリクスが悪化した場合、自動的に旧バージョンに戻す。

**3. リスク管理と現実解**
*   **エラーバジェット**: 100%の稼働を目指すのではなく、許容できるエラーの範囲（予算）を決め、その範囲内であればリスクを取ってリリース速度を上げるという考え方。
*   **現実的なリスクの取り方**: スピードが必要な場面では、ロールバック計画を用意した上で、一部のプロセスを省略する判断も必要になる場合がありますが、その際はステークホルダーへの事前周知や事後のモニタリング強化が不可欠です,。

## ポイント

*   **自動化への投資**: リリース頻度を高めつつ品質を維持するには、手動テストから自動テスト、さらには自動カナリアリリースや自動ロールバックといった高度なデプロイ機能への投資が必要です,。
*   **計測と可観測性**: リリースが安全かどうかを判断するには、システムの状態を示すメトリクス（CPU使用率、エラー率、ビジネス指標など）のモニタリングと、異常時のアラート設定が不可欠です。
*   **「完了」の定義**: コードを書くだけでなく、本番環境で安全に動作し、顧客に価値を届けるところまでがエンジニアの責任範囲です。
