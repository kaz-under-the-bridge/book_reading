# イテレーションを迅速に行うためのエンジニアリング上のプラクティス

## 概要

スタッフ＋エンジニアの目標は、自分だけでなく、共に働くチームやグループ全体の効率を改善することです。本セクションでは、開発サイクル（イテレーション）を高速化し、迅速かつ確実にソフトウェアをリリースするために、組織レベルで導入すべき主要なツールやプロセス（CI/CD、トランクベース開発、機能フラグ、モノリポなど）について解説されています。

## 詳細

*   **継続的インテグレーション（CI）**:
    *   コードを頻繁にメインブランチに統合し、自動ビルドとテスト（ユニットテスト、静的解析など）を実行することで、フィードバックを迅速化し、リグレッションを早期に検知します。
    *   **課題**: テスト実行時間の短縮が最大の課題です。コードのモジュール化とキャッシュ、テストの並列実行、変更箇所に関連するテストのみの実行などの対策が有効です。
*   **継続的デプロイ（CD）**:
    *   承認された変更を本番環境へ自動的にデプロイします。大規模システムでは、**段階的な自動ロールアウト（カナリアリリース）**や、異常検知時の**自動ロールバック**機能を備えることで、リスクを最小限に抑えます。
*   **トランクベース開発**:
    *   全員が単一の共有ブランチ（メイン）で作業する手法です。「唯一の信頼できる情報源」となり、マージの競合を減らしますが、堅牢なCI/CDと機能フラグの活用が前提となります。ビルドツールへの投資が必要です。
*   **機能フラグ**:
    *   コード内の変更をフラグの後ろに隠すことで、未完成の機能を本番環境に安全にマージしたり、特定のユーザー群にのみ新機能を公開したりすることを可能にします。トランクベース開発やモバイルアプリ開発、実験を行う企業で特に有用です。
*   **モノリポ（Monorepo）**:
    *   全ソースコードを単一の巨大なリポジトリで管理する手法（Google、Meta、Uberなどが採用）です。
    *   **長所**: 依存関係が明確になり、リファクタリングや統合テストが容易になります。
    *   **短所**: リポジトリのサイズが巨大化するため、専用のツール環境や部分的なチェックアウト機能などへの投資が必要です。
*   **マイクロサービス vs モノリシック**:
    *   どちらが適しているかは組織の規模やフェーズによります。中間的な現実解として、**複数モジュールから構成されるモノリス**（Shopifyの例）や、ドメインごとに構成されたマイクロサービス群（Uberの例）などが挙げられます。

## ポイント

*   **自動化への投資**: イテレーションを高速化するには、CI/CDや自動ロールバックなどのインフラ整備が不可欠であり、これには初期設定や保守のコストがかかりますが、長期的な生産性と信頼性の向上に寄与します。
*   **フィードバックループの短縮**: CI/CDやトランクベース開発の主な目的は、エンジニアがコードを書いてから結果を知るまでの時間を短縮することにあります。
*   **規模に応じた選択**: モノリポや高度なCDシステムは大規模テック企業では一般的ですが、その導入にはコストがかかるため、組織の課題やボトルネックに合わせて適切なプラクティスを選択する必要があります。
